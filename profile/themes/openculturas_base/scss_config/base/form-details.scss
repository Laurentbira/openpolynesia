// Height of Heading and Chevron.
// Increase to get space around details closed.


// @todo: does not work for longer titles, rethink variable maths
$line-height-details-header: 2.2;

.details-title {
  @extend .h2;
  color: inherit;
  display: inline-block;
  //line-height: $line-height-details-header;
  line-height: inherit;
  padding-top: .5rem;
  padding-bottom: .75rem;
  margin: 0;
  width: calc(100% - 2 * var(--font-size-icon));
}

details {
  border: 0;
  border-top: 1px solid $color-divider-light;
  padding: 0;
  margin-left: $grid-gutter; // form has no padding, see form.scss
  margin-right: $grid-gutter;
  width: 100%; // Required by ff.

  // Reverting form-wrapper default.
  &.form-wrapper {
    margin: 0;

    &:last-of-type {
      //border-bottom: 0;
      padding-bottom: .5rem;
    }
  }
  // Keep distance from non-details elements.
  &:last-of-type {
    border-bottom: 1px solid $color-divider-light;
    margin-bottom: $grid-gutter;
  }

  > summary {
    @include icon(chevron-down, fas, before);
    list-style: none;
    padding: 0;
    position: relative;

    // Disable default marker element on webkit browsers.
    &::-webkit-details-marker {
      display: none;
    }

    // Chevron  ▲ and ▼.
    &:before {
      border-radius: $button-border-radius;
      float: right;
      font-size: $font-size-icon;
      line-height: (0.9 * $line-height-details-header);
      margin-top: .1em;
      padding: 0 .5em;
      transition: transform 300ms ease;
      @include breakpoint(m) {
        // h2.details-title is responsive at breakpoint.
        margin-top: .25em;
      }
    }

    &:focus:before,
    &:hover:before {
      background: $color-interaction;
      color: $color-text-inverted;
    }

    &:active:before {
      background: transparent;
      color: $color-interaction;
      outline: $outline-active;
    }

    &:focus,
    &:hover {
      color: $color-interaction;
    }

    &.form-required {
      &:after {
        font-size: $font-size-l;
        position: absolute;
        right: 3rem;
        top: .5rem;
      }

      h2 {
        &:after {
          color: $color-danger;
          content: '*';
        }
      }
    }

  }

  &[open] {
    > summary:before {
      transform: rotate(-180deg);
    }
  }

  .details-wrapper {
    margin: 0;
    padding: $grid-gutter 0 (2*$grid-gutter);
  }
}

details {
  .node details {
    margin-bottom: 0;
    padding-bottom: 0;
    &.form-wrapper:last-of-type {
      padding-bottom: 0;
      border-bottom-width: 0;
    }
  }

  // Nested details, e. g. FAQ

  details {
    width: calc(100% - (2.5*$grid-gutter));
    margin: 0 (2*$grid-gutter) 0 0;
    border-bottom-width: 0;

    &:last-of-type {
      border-bottom-width: 0;
    }

    > summary::before {
      font-size: var(--font-size-m);
    }

    .details-title {
      @extend .h3;
      //font-family: var(--font-family-sans-serif);
      //font-size: var(--font-size-m);
      //color: var(--color-interaction);
      //font-weight: bold;
      //padding-top: .666rem;
    }

    .details-wrapper {
      padding-top: 0;
      padding-right: (2*$grid-gutter);
    }
  }
}

.legal-login {
  details .details-wrapper {
    padding-bottom: 0;
  }
}


/* Views exposed forms, secondary options */
details.bef--secondary {
  border-width: 0 0 1px;

  > summary .details-title {
    font-size: $font-size-default;
    font-family: $font-base;
    text-align: right;
    margin-right: 1rem;
  }

  > summary:before {
    font-size: $font-size-default;
  }
}

// Facets

.block-facets details {
  border-width: 0 0 1px;
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 1rem;

  > summary.h4 {
    &:before {
      font-size: var(--font-size-m);
      @include breakpoint(m) {
        margin-top: -.333rem;
      }
    }
  }

  ul {
    margin-top: $grid-gutter;
  }
}
